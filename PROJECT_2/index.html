<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIGNATURE WITH YOUR STYLE</title>
    <style>
        .signatureCanvas{
            border:2px solid black;
            margin-top:20px;
            background-color: white;
        }
        .top{
            display: flex;
            flex-direction: row;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 20px;
            gap: 20px;
        }
        .black,input,select,button{
            background-color: black;
            color: white;
            padding: 10px;
            border-radius: 50px;
            border: none;
            font-size: 16px;
        }
        .main{
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    .top>.black{
        margin: 10px;
    }
    .black>button{
        margin :10px;
    }
    .black>p{
        margin: 10px auto;
        width: 50%;
    }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="icon" type="image/x-icon" href="/HTML/images/favicon.ico" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body>
    <div class = "main">
        <div class ="top">
            <div class ="black">
                <p>Pick Out Of One color</p>
                <input type="color" id="colorPicker" name="colorPicker">
            </div>
            <div class ="black">
                <p>Pick Out Of background color</p>
        <!-- background color picker (id fixed) -->
        <input type="color" id="canvasColor" name="canvasColor">
        </div>
        <div class ="black">
            <p>Pick Out Of One Font size</p>
            <select name="fontSize" id="fontSizeSelect">
                <option value="12">12px</option>
                <option value="16" selected>16px</option>
                <option value="20">20px</option>
                <option value="24">24px</option>
                <option value="28">28px</option>
                <option value="32">32px</option>
            </select>
        </div>
    </div>
    <!-- canvas width/height should be numeric (no 'px') -->
    <canvas class = "signatureCanvas" id ="mycanvas" width="500" height="300"></canvas>
    <div class="bottom">
        <button id="clearBtn" class ="btn btn-danger">Clear</button>
        <button id="saveBtn" class ="btn btn-success">Save</button>
        <button id="retrieveBtn" class ="btn btn-info">Retrieve Saved Signature</button>
    </div>
    <script>
        // Elements
        const colorPicker = document.getElementById('colorPicker');
        const canvasColor = document.getElementById('canvasColor');
        const canvas = document.getElementById('mycanvas');
        const clearBtn = document.getElementById('clearBtn');
        const saveBtn = document.getElementById('saveBtn');
        const retrieveBtn = document.getElementById('retrieveBtn');
        const fontSizeSelect = document.getElementById('fontSizeSelect');

        // Canvas context
        const ctx = canvas.getContext('2d');

        // State
        let drawing = false;
        let lastX = 0, lastY = 0;
        let penColor = '#000000';
        let fontSize = 16;  

        // sensible defaults
        ctx.strokeStyle = penColor;
        ctx.lineWidth = fontSize / 4 || 4;

        // Color picker for pen
        colorPicker.addEventListener('change', (e) => {
            ctx.strokeStyle = e.target.value;
            ctx.fillStyle = e.target.value;
        });

        // Drawing handlers (use the event parameter 'e')
        canvas.addEventListener('mousedown', (e) => {
            drawing = true;
            lastX = e.offsetX;
            lastY = e.offsetY;
        });
        canvas.addEventListener('mousemove', (e) => {
            if (drawing) {
               ctx.beginPath();
               ctx.moveTo(lastX, lastY);
               ctx.lineTo(e.offsetX, e.offsetY);
               ctx.stroke();
               lastX = e.offsetX;
               lastY = e.offsetY;
            }
        });
        // stop drawing on mouseup or when leaving canvas
        canvas.addEventListener('mouseup', () => drawing = false);
        canvas.addEventListener('mouseleave', () => drawing = false);

        // Background color picker for canvas
        canvasColor.addEventListener('change', (e) => {
            // fill the canvas background with selected color
            ctx.save();
            ctx.fillStyle = e.target.value;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.restore();
        });

        // Font/pen size â€” option values are numeric
        fontSizeSelect.addEventListener('change', (e) => {
            const val = Number(e.target.value);
            if (!isNaN(val)) ctx.lineWidth = val / 4; // scale to a reasonable line width
        });

        // Clear canvas
        clearBtn.addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        });

        // Save image
        saveBtn.addEventListener('click', () => {
            const dataURL = canvas.toDataURL('image/png');
            localStorage.setItem('savedSignature', dataURL);
            const link = document.createElement('a');
            link.href = dataURL;
            link.download = 'signature.png';
            document.body.appendChild(link);
            link.click();
            link.remove();
            alert('Signature saved!');
        });

        // Retrieve saved image
        retrieveBtn.addEventListener('click', () => {
            const dataURL = localStorage.getItem('savedSignature');
            if (dataURL) {
                const img = new Image();
                img.onload = function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                };
                img.src = dataURL;
            } else {
                alert('No saved signature found.');
            }
        });
    </script>
</body>
</html>